# ASR backend: local (faster-whisper) or cloudflare
ASR_BACKEND=local

# Local Whisper — model loaded ONCE at startup (singleton)
LOCAL_WHISPER_MODEL=base
# base | small | medium | large-v3
LOCAL_WHISPER_DEVICE=cpu
# cpu | cuda
LOCAL_WHISPER_COMPUTE_TYPE=int8
# int8 | float16 (float16 needs cuda for best speed)
# Partial (faster) vs final (stable) decode
LOCAL_WHISPER_BEAM_SIZE_PARTIAL=1
LOCAL_WHISPER_BEAM_SIZE_FINAL=5
LOCAL_WHISPER_WORD_TIMESTAMPS=true

# Cloudflare Workers AI: ASR (when ASR_BACKEND=cloudflare) and refine-transcript (LLM)
CLOUDFLARE_ACCOUNT_ID=your_account_id
CLOUDFLARE_API_TOKEN=your_api_token

# Optional backend recording (one file per WebSocket session). Disabled by default.
ENABLE_AUDIO_RECORDING=false
ENABLE_BACKEND_RECORDING=false
BACKEND_RECORD_FORMAT=wav
# wav | mp3 (wav preferred: no re-encode, safe lifecycle)
BACKEND_RECORD_DIR=./recordings
BACKEND_RECORD_GAIN=2.0
# 1.5–4.0 gain applied only to recorded file; STT stream unchanged
BACKEND_RECORD_BITRATE=128k
# for MP3 only

# Session transcript storage: one .txt per WebSocket (final segments only, append-only)
TRANSCRIPT_SAVE_ENABLED=true
TRANSCRIPT_DIR=./transcripts
TRANSCRIPT_ADD_TIMESTAMPS=false

# Real-time STT: rolling buffer (default) vs silence-based chunker
STT_USE_ROLLING_BUFFER=true
STT_WINDOW_SECONDS=5.0
STT_STEP_SECONDS=1.0
STT_MIN_CHUNK_SECONDS=0.5
STT_COMMIT_AGE_SECONDS=2.0

# Optional overrides (legacy chunking when STT_USE_ROLLING_BUFFER=false)
CHUNK_DURATION_MS=1500
OVERLAP_MS=300
SILENCE_COMMIT_MS=600

# Context-aware re-transcription: Cloudflare Workers AI (free tier), no OpenAI/GPT
# Uses same CLOUDFLARE_ACCOUNT_ID / CLOUDFLARE_API_TOKEN as above
REFINE_CHAT_ENABLED=true
REFINE_CF_MODEL=@cf/meta/llama-3.1-8b-instruct
REFINE_CHAT_MAX_TOKENS=2048
REFINE_AUDIO_REFERENCE_SECONDS=30.0

# PICOVOICE_API_KEY=your_pico_voice_api_key